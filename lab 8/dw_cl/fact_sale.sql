alter session set current_schema = DW_DATA;

CREATE TABLE FACT_SALE(
    SALE_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    DATE_ID                  DATE, 
    LOCATION_ID              NUMBER,
    PIZZERIA_ID              NUMBER,
    PIZZA_ID               NUMBER,
    PERIOD_ID           NUMBER,
    SOLD_NUMBER_PIZZA   NUMBER,
    CONSTRAINT "PK_T.FACT_SALE" PRIMARY KEY(SALE_ID),
    CONSTRAINT "FK_FACT_SALE_DIM_DATE" FOREIGN KEY (DATE_ID )REFERENCES dim_date (DATE_ID),
    CONSTRAINT "FK_FACT_SALE_DIM_LOCATION" FOREIGN KEY (LOCATION_ID )REFERENCES dim_location (LOCATION_ID),
    CONSTRAINT "FK_FACT_SALE_DIM_PIZZERIA" FOREIGN KEY (PIZZERIA_ID )REFERENCES dim_pizzeria (PIZZERIA_ID),
    CONSTRAINT "FK_FACT_SALE_DIM_PIZZA" FOREIGN KEY (PIZZA_ID )REFERENCES dim_pizza (PIZZA_ID),
    CONSTRAINT "FK_FACT_SALE_DIM_PERIOD" FOREIGN KEY (PERIOD_ID )REFERENCES dim_period (PERIOD_ID)   
);